{"version":3,"sources":["state.js"],"names":["MeetingStateMachine","create","meeting","StateMachine","init","MEETING_STATE_MACHINE","STATES","IDLE","transitions","name","TRANSITIONS","START","from","to","ON_GOING","INCOMING","JOIN","DIALING","LOCAL","CONNECTING_MEDIA_LOCAL","CONNECT","CONNECTING_MEDIA_REMOTE","ESTABLISH","ESTABLISHED_MEDIA","LEAVE","TERMINATING","END","ENDED","CLEAN","ERROR","methods","onInit","transition","logger","log","event","id","onError","onClean","onJoin","onLocal","onConnect","onEstablish","plugins","StateMachineHistory","max"],"mappings":"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","file":"state.js","sourcesContent":["import StateMachine from 'javascript-state-machine';\nimport StateMachineHistory from 'javascript-state-machine/lib/history';\n\nimport {MEETING_STATE_MACHINE} from '../constants';\n\nconst MeetingStateMachine = {\n  /**\n   * Initializes the StateMachine for the meeting\n   * @param {Meeting} meeting A meeting instance\n   * @returns {StateMachine}\n   */\n  create(meeting) {\n    return new StateMachine({\n      init: MEETING_STATE_MACHINE.STATES.IDLE,\n      transitions: [\n        {\n          name: MEETING_STATE_MACHINE.TRANSITIONS.START,\n          from: MEETING_STATE_MACHINE.STATES.IDLE,\n          to: MEETING_STATE_MACHINE.STATES.ON_GOING\n        },\n        {\n          name: MEETING_STATE_MACHINE.TRANSITIONS.START,\n          from: MEETING_STATE_MACHINE.STATES.IDLE,\n          to: MEETING_STATE_MACHINE.STATES.INCOMING\n        },\n        {\n          name: MEETING_STATE_MACHINE.TRANSITIONS.JOIN,\n          from: MEETING_STATE_MACHINE.STATES.IDLE,\n          to: MEETING_STATE_MACHINE.STATES.DIALING\n        },\n        {\n          name: MEETING_STATE_MACHINE.TRANSITIONS.JOIN,\n          from: MEETING_STATE_MACHINE.STATES.ON_GOING,\n          to: MEETING_STATE_MACHINE.STATES.DIALING\n        },\n        {\n          name: MEETING_STATE_MACHINE.TRANSITIONS.JOIN,\n          from: MEETING_STATE_MACHINE.STATES.INCOMING,\n          to: MEETING_STATE_MACHINE.STATES.DIALING\n        },\n        {\n          name: MEETING_STATE_MACHINE.TRANSITIONS.LOCAL,\n          from: MEETING_STATE_MACHINE.STATES.DIALING,\n          to: MEETING_STATE_MACHINE.STATES.CONNECTING_MEDIA_LOCAL\n        },\n        {\n          name: MEETING_STATE_MACHINE.TRANSITIONS.CONNECT,\n          from: MEETING_STATE_MACHINE.STATES.CONNECTING_MEDIA_LOCAL,\n          to: MEETING_STATE_MACHINE.STATES.CONNECTING_MEDIA_REMOTE\n        },\n        {\n          name: MEETING_STATE_MACHINE.TRANSITIONS.ESTABLISH,\n          from: MEETING_STATE_MACHINE.STATES.CONNECTING_MEDIA_REMOTE,\n          to: MEETING_STATE_MACHINE.STATES.ESTABLISHED_MEDIA\n        },\n        {\n          name: MEETING_STATE_MACHINE.TRANSITIONS.LEAVE,\n          from: MEETING_STATE_MACHINE.STATES.ESTABLISHED_MEDIA,\n          to: MEETING_STATE_MACHINE.STATES.TERMINATING\n        },\n        {\n          name: MEETING_STATE_MACHINE.TRANSITIONS.END,\n          from: MEETING_STATE_MACHINE.STATES.TERMINATING,\n          to: MEETING_STATE_MACHINE.STATES.ENDED\n        },\n        {\n          name: MEETING_STATE_MACHINE.TRANSITIONS.CLEAN,\n          from: MEETING_STATE_MACHINE.STATES.ENDED,\n          to: MEETING_STATE_MACHINE.STATES.IDLE\n        },\n        {\n          name: MEETING_STATE_MACHINE.TRANSITIONS.CLEAN,\n          from: MEETING_STATE_MACHINE.STATES.ERROR,\n          to: MEETING_STATE_MACHINE.STATES.IDLE\n        },\n        {\n          name: MEETING_STATE_MACHINE.TRANSITIONS.ERROR,\n          from: '*',\n          to: MEETING_STATE_MACHINE.STATES.ERROR\n        }\n      ],\n      methods: {\n        onInit: (transition) => {\n          meeting.logger.log(\n            `Meeting:index#onInit->${transition.event} fired! State changed from '${transition.from}' to '${\n              transition.to\n            }' with transition '${transition.transition}' on Meeting Object: '${this.id}'.`\n          );\n        },\n        onError: (transition) => {\n          meeting.logger.log(\n            `Meeting:index#onError->${transition.event} fired! State changed from '${transition.from}' to '${\n              transition.to\n            }' with transition '${transition.transition}' on Meeting Object: '${this.id}'.`\n          );\n        },\n        onClean: (transition) => {\n          meeting.logger.log(\n            `Meeting:index#onClean->${transition.event} fired! State changed from '${transition.from}' to '${\n              transition.to\n            }' with transition '${transition.transition}' on Meeting Object: '${this.id}'.`\n          );\n        },\n        onJoin: (transition) => {\n          meeting.logger.log(\n            `Meeting:index#onJoin->${transition.event} fired! State changed from '${transition.from}' to '${\n              transition.to\n            }' with transition '${transition.transition}' on Meeting Object: '${this.id}'.`\n          );\n        },\n        onLocal: (transition) => {\n          meeting.logger.log(\n            `Meeting:index#onLocal->${transition.event} fired! State changed from '${transition.from}' to '${\n              transition.to\n            }' with transition '${transition.transition}' on Meeting Object: '${this.id}'.`\n          );\n        },\n        onConnect: (transition) => {\n          meeting.logger.log(\n            `Meeting:index#onConnect->${transition.event} fired! State changed from '${transition.from}' to '${\n              transition.to\n            }' with transition '${transition.transition}' on Meeting Object: '${this.id}'.`\n          );\n        },\n        onEstablish: (transition) => {\n          meeting.logger.log(\n            `Meeting:index#onEstablish->${transition.event} fired! State changed from '${transition.from}' to '${\n              transition.to\n            }' with transition '${transition.transition}' on Meeting Object: '${this.id}'.`\n          );\n        }\n      },\n      plugins: [new StateMachineHistory({max: 25})]\n    });\n  }\n};\n\nexport default MeetingStateMachine;\n"]}